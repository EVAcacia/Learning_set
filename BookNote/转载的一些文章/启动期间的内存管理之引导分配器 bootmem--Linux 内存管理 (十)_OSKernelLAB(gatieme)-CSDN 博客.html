
                <html lang="en" class="simpread-font simpread-theme-root" style='undefined'>
                    <head>
                        <meta charset="utf-8">
                        <meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin"/>
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展" />
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey"/>
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN"/>
                        <meta property="og:url" content="http://ksria.com/simpread"/>
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png"/>
                        <meta property="og:image:type" content="image/png"/>
                        <meta property="og:image:width" content="960"/>
                        <meta property="og:image:height" content="355"/>
                        <meta property="og:site_name" content="http://ksria.com/simpread"/>
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展"/>
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-night{display:none}sr-rd-content h1{margin-top:2em}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{color:#dedede;font-weight:400;clear:both;-ms-word-wrap:break-word;word-wrap:break-word;margin:0;padding:0}sr-rd-content h1{font-size:57.6px;font-size:3.6rem;line-height:64px;line-height:4rem;margin-bottom:38.4px;margin-bottom:2.4rem;letter-spacing:-1.5px}sr-rd-content h2{font-size:38.4px;font-size:2.4rem;line-height:48px;line-height:3rem}sr-rd-content h2,sr-rd-content h3{margin-bottom:38.4px;margin-bottom:2.4rem;letter-spacing:-1px}sr-rd-content h3{font-size:28.8px;font-size:1.8rem;line-height:38.4px;line-height:2.4rem}sr-rd-content h4{font-size:25.6px;font-size:1.6rem;line-height:35.2px;line-height:2.2rem;margin-bottom:38.4px;margin-bottom:2.4rem}sr-rd-content h5{font-size:16px;font-size:1rem;line-height:20px;line-height:1.25rem;margin-bottom:24px;margin-bottom:1.5rem}sr-rd-content h6{font-size:25.6px;font-size:1.6rem;line-height:25.6px;line-height:1.6rem;margin-bottom:12px;margin-bottom:.75rem;font-weight:700}sr-rd-content ol,sr-rd-content ul{padding:0 0 0 30px;padding:0 0 0 1.875rem}sr-rd-content ul{list-style:square}sr-rd-content ol{list-style:decimal}sr-rd-content ol ol,sr-rd-content ol ul,sr-rd-content ul ol,sr-rd-content ul ul{margin:0}sr-rd-content li div{padding-top:0}sr-rd-content li,sr-rd-content li p{margin:0;position:relative}sr-rd-content table{margin-top:0;margin-bottom:24px;margin-bottom:1.5rem;border-collapse:collapse;border-spacing:0;page-break-inside:auto;text-align:left}sr-rd-content table a{color:#dedede}sr-rd-content thead{display:table-header-group}sr-rd-content table td,sr-rd-content table th{border:1px solid #474d54}sr-rd-content sr-blockquote{margin:0 0 30px 30px;margin:0 0 1.875rem 1.875rem;border-left:2px solid #474d54;padding-left:30px;margin-top:35px;line-height:2}.simpread-multi-root,.simpread-theme-root{background:#363b40;color:#b8bfc6}sr-rd-title{color:#dedede;font-size:50.4px;font-size:3.15rem;line-height:56px;line-height:3.5rem;letter-spacing:-1.5px}sr-rd-desc{margin:35px;margin-left:0;padding-left:30px;padding-left:1.875rem;font-size:32px;font-size:2rem;line-height:2;border-left:2px solid #474d54}sr-rd-content,sr-rd-desc{color:#b8bfc6}sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#b8bfc6;margin-top:0;line-height:2}sr-rd-content a,sr-rd-content a:link{color:#e0e0e0;text-decoration:underline;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{color:#fff}sr-rd-content pre{background-color:transparent;border:1px solid}sr-rd-content li code,sr-rd-content p code{background:rgba(0,0,0,.05)}sr-rd-mult{background-color:#2d3034}panel{background-color:#2e2e2e!important}panel panel-tab span{color:#fff}panel sr-opt-gp sr-opt-label{color:rgba(108,255,240,.8);font-weight:400}panel text-field-float{color:rgba(108,255,240,.8)!important;font-weight:400!important}panel list-field{background-color:transparent!important}panel list-field:hover list-field-name{color:#fff!important;font-weight:700}panel input,panel list-field-name{color:hsla(35,10%,76%,.87)!important}panel list-view{background-color:#2e2e2e!important}panel sr-opt-gp action-label,panel switch content *{color:#fff!important}panel-tabs{border-bottom-color:#393d40!important}sr-annote{color:#333}sr-annote-sidebar *{color:hsla(36,10%,90%,.9)!important}sr-annote-sidebar-card[type=unread]{background-color:#19896e!important}sr-annote-sidebar-card:hover{box-shadow:0 10px 20px 0 rgba(60,73,82,.6)!important}sr-annote-sidebar-note,sr-annote-sidebar-options,sr-annote-sidebar-toolbars{background-color:#282b2d!important}sr-rd-theme-night-comp{display:none;opacity:0}dialog-content,dialog-footer{color:#b8bfc6!important;background-color:#2e2e2e!important}dialog-content *{color:#b8bfc6!important}dialog-content svg path{fill:#b8bfc6!important}dialog-content button-text{color:#b8bfc6!important}dialog-content text-field-state{border-top:none #b8bfc6!important;border-left:none #b8bfc6!important;border-right:none #b8bfc6!important;border-bottom:2px solid #b8bfc6!important}dialog-footer button-text{color:#b8bfc6!important}auto-complete list-view,dropdown list-view{color:#b8bfc6!important;background-color:#2e2e2e!important}auto-complete list-field,dropdown list-field{-webkit-transition:all .45s cubic-bezier(.23,1,.32,1) 0ms;transition:all .45s cubic-bezier(.23,1,.32,1) 0ms}auto-complete list-field[active=true],dropdown list-field[active=true]{color:#b8bfc6!important;background-color:#1b1b1b!important}auto-complete tag{background-color:#1b1b1b!important}sr-rd-theme-night-comp{display:none}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">.markdown_views pre code{background-color:transparent!important;}sr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        <style>sr-rd-content * { color: rgb(235, 235, 235)!important }</style>
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        
                        <title>简悦 | 启动期间的内存管理之引导分配器 bootmem--Linux 内存管理 (十)_OSKernelLAB(gatieme)-CSDN 博客</title>
                    </head>
                    <body>
                        <sr-read style='undefined'>
                            <sr-rd-title>启动期间的内存管理之引导分配器 bootmem--Linux 内存管理 (十)_OSKernelLAB(gatieme)-CSDN 博客</sr-rd-title>
                    
                    <sr-rd-content><p></p><div><table><thead><tr><th>日期</th><th align="center">内核版本</th><th align="center">架构</th><th align="center">作者</th><th align="center"> GitHub</th><th align="center">CSDN</th></tr></thead><tbody><tr><td>2016-09-01</td><td align="center"><a href="http://lxr.free-electrons.com/source/?v=4.7">Linux-4.7</a></td><td align="center">X86 &amp; arm</td><td align="center"><a href="http://blog.csdn.net/gatieme">gatieme</a></td><td align="center"><a href="https://github.com/gatieme/LDD-LinuxDeviceDrivers">LinuxDeviceDrivers</a></td><td align="center"><a href="http://blog.csdn.net/gatieme/article/details/52384965">Linux 内存管理</a></td></tr></tbody></table></div><p></p><p>在内存管理的上下文中, 初始化 (initialization) 可以有多种含义. 在许多 CPU 上, 必须显式设置适用于 Linux 内核的内存模型. 例如在 x86_32 上需要切换到保护模式, 然后内核才能检测到可用内存和寄存器.</p><p></p><p>而我们今天要讲的 bootmem 分配器就是系统初始化阶段使用的内存分配器. </p><p></p><p>为什么要使用 bootmem 分配器，内存管理不是有 buddy 系统和 slab 分配器吗？由于在系统初始化的时候需要执行一些内存管理，内存分配的任务，这个时候 buddy 系统，slab 分配器等并没有被初始化好，此时就引入了一种内存管理器 bootmem 分配器在系统初始化的时候进行内存管理与分配，当 buddy 系统和 slab 分配器初始化好后，在 mem_init() 中对 bootmem 分配器进行释放，内存管理与分配由 buddy 系统，slab 分配器等进行接管。</p><p></p><p>bootmem 分配器使用一个 bitmap 来标记物理页是否被占用，分配的时候按照第一适应的原则，从 bitmap 中进行查找，如果这位为 1，表示已经被占用，否则表示未被占用。为什么系统运行的时候不使用 bootmem 分配器呢？bootmem 分配器每次在 bitmap 中进行线性搜索，效率非常低，而且在内存的起始端留下许多小的空闲碎片，在需要非常大的内存块的时候，检查位图这一过程就显得代价很高。bootmem 分配器是用于在启动阶段分配内存的，对该分配器的需求集中于简单性方面，而不是性能和通用性.</p><p></p><h1 id="sr-toc-0"><a name="t0"></a>1 前景回顾</h1><p></p><p></p><h2 id="sr-toc-1"><a name="t1"></a>1.1 Linux 内存管理的层次结构</h2><p></p><p></p><p>Linux 把物理内存划分为三个层次来管理</p><p></p><div><table><thead><tr><th align="center">层次</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">存储节点 (Node)</td><td align="center">CPU 被划分为多个节点 (node), 内存则被分簇, 每个 CPU 对应一个本地物理内存, 即一个 CPU-node 对应一个内存簇 bank，即每个内存簇被认为是一个节点</td></tr><tr><td align="center">管理区 (Zone)</td><td align="center"> 每个物理内存节点 node 被划分为多个内存管理区域, 用于表示不同范围的内存, 内核可以使用不同的映射方式映射物理内存</td></tr><tr><td align="center">页面 (Page)</td><td align="center"> 内存被细分为多个页面帧, 页面是最基本的页面分配的单位　｜</td></tr></tbody></table></div><p></p><p>为了支持 NUMA 模型，也即 CPU 对不同内存单元的访问时间可能不同，此时系统的物理内存被划分为几个节点 (node), 一个 node 对应一个内存簇 bank，即每个内存簇被认为是一个节点</p><p></p><ul><li><p>首先, 内存被划分为<strong>结点</strong>. 每个节点关联到系统中的一个处理器, 内核中表示为<code>pg_data_t</code>的实例. 系统中每个节点被链接到一个以 NULL 结尾的<code>pgdat_list</code>链表中 &lt; 而其中的每个节点利用<code>pg_data_tnode_next</code>字段链接到下一节．而对于 PC 这种 UMA 结构的机器来说, 只使用了一个成为 contig_page_data 的静态 pg_data_t 结构.</p></li><li><p> 接着各个节点又被划分为内存管理区域, 一个<strong>管理区域</strong>通过 struct zone_struct 描述, 其被定义为 zone_t, 用以表示内存的某个范围, 低端范围的 16MB 被描述为 ZONE_DMA, 某些工业标准体系结构中的 (ISA) 设备需要用到它, 然后是可直接映射到内核的普通内存域 ZONE_NORMAL, 最后是超出了内核段的物理地址域 ZONE_HIGHMEM, 被称为高端内存.　是系统中预留的可用内存空间, 不能被内核直接映射.</p></li><li><p> 最后<strong>页帧 (page frame)</strong> 代表了系统内存的最小单位, 堆内存中的每个页都会创建一个 struct page 的一个实例. 传统上，把内存视为连续的字节，即内存为字节数组，内存单元的编号 (地址) 可作为字节数组的索引. 分页管理时，将若干字节视为一页，比如 4K byte. 此时，内存变成了连续的页，即内存为页数组，每一页物理内存叫页帧，以页为单位对内存进行编号，该编号可作为页数组的索引，又称为页帧号.</p></li></ul><p></p><h2 id="sr-toc-2"><a name="t2"></a>1.2 start_kernel 启动过程</h2><p></p><p></p><p>在初始化过程中, 还必须建立内存管理的数据结构, 以及很多事务. 因为内核在内存管理完全初始化之前就需要使用内存. 在系统启动过程期间, 使用了额外的简化悉尼股市的内存管理模块, 然后在初始化完成后, 将旧的模块丢弃掉.</p><p></p><p>首先我们来看看 start_kernel 是如何初始化系统的, start_kerne 定义在 <a href="http://lxr.free-electrons.com/source/init/main.c?v=4.7#L479">init/main.c?v=4.7, line 479</a></p><p></p><p>其代码很复杂, 我们只截取出其中与内存管理初始化相关的部分, 如下所示</p><p></p><pre name="code" class="hljs cpp">asmlinkage __visible <span class="hljs-keyword">void</span> __<span class="hljs-function">init <span class="hljs-title">start_kernel</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{

    setup_arch(&amp;command_line);
    mm_init_cpumask(&amp;init_mm);

    setup_per_cpu_areas();


    build_all_zonelists(<span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
    page_alloc_init();


    <span class="hljs-comment">/*
     * These use large bootmem allocations and must precede
     * mem_init();
     * kmem_cache_init();
     */</span>
    mm_init();

    kmem_cache_init_late();

    kmemleak_init();
    setup_per_cpu_pageset();

    rest_init();
}</pre><p></p><div><table><thead><tr><th align="center">函数</th><th align="center">功能 </th></tr></thead><tbody><tr><td align="center"><a href="http://lxr.free-electrons.com/ident?v=4.7;i=setup_arch">setup_arch</a></td><td align="center"> 是一个特定于体系结构的设置函数, 其中一项任务是负责初始化自举分配器 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/mm_types.h?v=4.7#L522">mm_init_cpumask</a></td><td align="center"> 初始化 CPU 屏蔽字 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/ident?v=4.7;i=setup_per_cpu_areas">setup_per_cpu_areas</a></td><td align="center"> 函数 <a href="http://lxr.free-electrons.com/source/mm/percpu.c?v4.7#L2205%5d">(查看定义)</a> 给每个 CPU 分配内存，并拷贝. data.percpu 段的数据. 为系统中的每个 CPU 的 per_cpu 变量申请空间.<br>在 SMP 系统中, setup_per_cpu_areas 初始化源代码中 (使用 <a href="http://lxr.free-electrons.com/source/include/linux/percpu-defs.h#L256">per_cpu 宏</a>) 定义的静态 per-cpu 变量, 这种变量对系统中每个 CPU 都有一个独立的副本. <br>此类变量保存在内核二进制影像的一个独立的段中, setup_per_cpu_areas 的目的就是为系统中各个 CPU 分别创建一份这些数据的副本<br>在非 SMP 系统中这是一个空操作 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/mm/page_alloc.c?v4.7#L5029">build_all_zonelists</a></td><td align="center"> 建立并初始化结点和内存域的数据结构 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/init/main.c?v4.7#L464">mm_init</a></td><td align="center"> 建立了内核的内存分配器, <br>其中通过 <a href="http://lxr.free-electrons.com/ident?v=4.7&amp;i=mem_init">mem_init</a> 停用 bootmem 分配器并迁移到实际的内存管理器 (比如伙伴系统)<br>然后调用 kmem_cache_init 函数初始化内核内部用于小块内存区的分配器 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/mm/slab.c?v4.7#L1378">kmem_cache_init_late</a></td><td align="center"> 在 kmem_cache_init 之后, 完善分配器的缓存机制,　当前 3 个可用的内核内存分配器 <a href="http://lxr.free-electrons.com/source/mm/slab.c?v4.7#L1378">slab</a>, <a href="http://lxr.free-electrons.com/source/mm/slob.c?v4.7#L655">slob</a>, <a href="http://lxr.free-electrons.com/source/mm/slub.c?v=4.7#L3960">slub</a> 都会定义此函数 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/mm/kmemleak.c?v=4.7#L1857">kmemleak_init</a></td><td align="center">Kmemleak 工作于内核态，Kmemleak 提供了一种可选的内核泄漏检测，其方法类似于跟踪内存收集器。当独立的对象没有被释放时，其报告记录在 <a href="http://lxr.free-electrons.com/source/mm/kmemleak.c?v=4.7#L1467">/sys/kernel/debug/kmemleak</a> 中, Kmemcheck 能够帮助定位大多数内存错误的上下文 </td></tr><tr><td align="center"><a href="http://lxr.free-electrons.com/source/mm/page_alloc.c?v=4.7#L5392">setup_per_cpu_pageset</a></td><td align="center"> 初始化 CPU 高速缓存行, 为 pagesets 的第一个数组元素分配内存, 换句话说, 其实就是第一个系统处理器分配<br>由于在分页情况下，每次存储器访问都要存取多级页表，这就大大降低了访问速度。所以，为了提高速度，在 CPU 中设置一个最近存取页面的高速缓存硬件机制，当进行存储器访问时，先检查要访问的页面是否在高速缓存中.</td></tr></tbody></table></div><p></p><h2 id="sr-toc-3"><a name="t3"></a>1.3 setup_arch 设置</h2><p></p><p></p><h1 id="sr-toc-4"><a name="t4"></a>2 引导内存分配器 bootmem 概述</h1><p></p><p></p><p>由于硬件配置多种多样, 所以在编译时就静态初始化所有的内核存储结构是不现实的.</p><p></p><p>bootmem 分配器是系统启动初期的内存分配方式，在耳熟能详的伙伴系统建立前内存都是利用 bootmem 分配器来分配的，伙伴系统框架建立起来后，bootmem 会过度到伙伴系统.</p><p></p><h2 id="sr-toc-5"><a name="t5"></a>2.1 初始化阶段的引导内存分配器 bootmem</h2><p></p><p></p><p>在启动过程期间, 尽管内存管理尚未初始化, 但是内核仍然需要分配内存以创建各种数据结构. 因此在系统启动过程期间, 内核使用了一个额外的简化形式的内存管理模块<strong>引导内存分配器 (boot memory allocator–bootmem 分配器)</strong>, 用于在启动阶段早期分配内存, 而在系统初始化完成后, 该分配器被内核抛弃, 然后初始化了一套新的更加完善的内存分配器.</p><p></p><p>显然, 对该内存分配器的需求集中于简单性方面,　而不是性能和通用性, 它仅用于初始化阶段. 因此内核开发者决定实现一个最先适配 (first-first) 分配器用于在启动阶段管理内存. 这是可能想到的最简单的方式.</p><p></p><p><strong>引导内存分配器 (boot memory allocator–bootmem 分配器)</strong> 基于最先适配 (first-first) 分配器的原理(这儿是很多系统的内存分配所使用的原理), 使用一个位图来管理页, 以位图代替原来的空闲链表结构来表示存储空间, 位图的比特位的数目与系统中物理内存页面数目相同. 若位图中某一位是 1, 则标识该页面已经被分配(已用页), 否则表示未被占有(未用页).</p><p></p><p>在需要分配内存时, 分配器逐位的扫描位图, 直至找到一个能提供足够连续页的位置, 即所谓的最先最佳 (first-best) 或最先适配位置.</p><p></p><p>该分配机制通过记录上一次分配的页面帧号 (PFN) 结束时的偏移量来实现分配大小小于一页的空间, 连续的小的空闲空间将被合并存储在一页上.</p><p></p><h2 id="sr-toc-6"><a name="t6"></a>2.2 为什么需要 bootmem</h2><p></p><p></p><h2 id="sr-toc-7"><a name="t7"></a>2.3 为什么在系统运行时抛弃 bootmem</h2><p></p><p></p><p>当系统运行时, 为何不继续使用 bootmem 分配机制呢?</p><p></p><ul><li><p>其中一个关键原因在于 : 但它每次分配都必须从头扫描位图, 每次通过对内存域进行线性搜索来实现分配.</p></li><li><p> 其次首先适应算法容易在内存的起始断留下许多小的空闲碎片, 在需要分配较大的空间页时,　检查位图的成本将是非常高的.</p></li></ul><p></p><p>引导内存分配器 bootmem 分配器简单却非常低效,　因此在内核完全初始化之后,　不能将该分配器继续欧诺个与内存管理,　而伙伴系统 (连同 slab, slub 或者 slob 分配器) 是一个好很多的备选方案．</p><p></p><h1 id="sr-toc-8"><a name="t8"></a>3 引导内存分配器数据结构</h1><p></p><p></p><p>内核用 bootmem_data 表示引导内存区域</p><p></p><p>即使是初始化用的最先适配分配器也必须使用一些数据结构存, 内核为系统中每一个结点都提供了一个 struct bootmem_data 结构的实例, 用于 bootmem 的内存管理. 它含有引导内存分配器给结点分配内存时所需的信息. 当然, 这时候内存管理还没有初始化, 因而该结构所需的内存是无法动态分配的, 必须在编译时分配给内核.</p><p></p><p>在 UMA 系统上该分配的实现与 CPU 无关, 而 NUMA 系统内存结点与 CPU 相关联, 因此采用了特定体系结构的解决方法.</p><p></p><h2 id="sr-toc-9"><a name="t9"></a>3.1 bootmem_data 描述内存引导区</h2><p></p><p></p><p>bootmem_data 的结构定义在 <a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L28">include/linux/bootmem.h?v=4.7, line 28</a>, 其定义如下所示</p><p></p><pre name="code" class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CONFIG_NO_BOOTMEM</span>
<span class="hljs-comment">/*
* node_bootmem_map is a map pointer - the bits represent all physical 
* memory pages (including holes) on the node.
*/</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bootmem_data</span> {</span>
       <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> node_min_pfn;
       <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> node_low_pfn;
       <span class="hljs-keyword">void</span> *node_bootmem_map;
       <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> last_end_off;
       <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> hint_idx;
       <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">list</span>;</span>
} <span class="hljs-keyword">bootmem_data_t</span>;

<span class="hljs-keyword">extern</span> <span class="hljs-keyword">bootmem_data_t</span> bootmem_node_data[];

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></pre><p></p><div><table><thead><tr><th align="center">字段</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"> node_min_pfn</td><td align="center"> 节点起始地址</td></tr><tr><td align="center"> node_low_pfn</td><td align="center"> 低端内存最后一个 page 的页帧号</td></tr><tr><td align="center"> node_bootmem_map</td><td align="center"> 指向内存中位图 bitmap 所在的位置</td></tr><tr><td align="center"> last_end_off</td><td align="center"> 分配的最后一个页内的偏移，如果该页完全使用，则 offset 为 0</td></tr><tr><td align="center">hint_idx</td><td align="center"></td></tr><tr><td align="center">list</td><td align="center"></td></tr></tbody></table></div><p></p><p>bootmem 的位图建立在从 start_pfn 开始的地方, 也就是说, 内核映像终点_end 上方的地方. 这个位图用来管理低区（例如小于 896MB), 因为在 0 到 896MB 的范围内, 有些页面可能保留, 有些页面可能有空洞, 因此, 建立这个位图的目的就是要搞清楚哪一些物理页面是可以动态分配的</p><p></p><ul><li><p>node_bootmem_map 就是一个指向位图的指针. node_min_pfn 表示存放 bootmem 位图的第一个页面 (即内核映像结束处的第一个页面)</p></li><li><p>node_low_pfn 表示物理内存的顶点, 最高不超过 896MB</p></li></ul><p></p><h1 id="sr-toc-10"><a name="t10"></a>4 初始化引导分配器</h1><p></p><p></p><p>系统是从 start_kernel 开始启动的, 在启动过程中通过调用体系结构相关的 setup_arch 函数, 来获取初始化引导内存分配器所需的参数信息, 各种体系结构都有对应的函数来获取这些信息, 在获取信息完成后, 内核首先初始化了 bootmem 自身, 然后接着又用 bootmem 分配和初始化了内存结点和管理域, 因此初始化 bootmem 的工作主要分成两步</p><p></p><ul><li><p>初始化 bootmem 自身的数据结构</p></li><li><p>用 bootmem 初始化内存结点管理域</p></li></ul><p></p><p>bootmem 分配器的初始化是一个特定于体系结构的过程, 此外还取决于系统的内存布局</p><p></p><p>系统是从 start_kernel 开始启动的, 在启动过程中通过调用体系结构相关的 setup_arch 函数, 来获取初始化引导内存分配器所需的参数信息, 各种体系结构都有对应的函数来获取这些信息.</p><p></p><h2 id="sr-toc-11"><a name="t11"></a>4.1 IA-32 的初始化</h2><p></p><p></p><p>在使用 bootmem, 内核在 setup_arch 函数中通过 <a href="http://lxr.free-electrons.com/source/arch/i386/kernel/setup.c?v=2.4.37#L1045">setup_memory</a> 来分析检测到的内存区, 以找到低端内存区中最大的页帧号。由于高端内存处理太麻烦，由此对 bootmem 分配器无用。全局变量 max_low_pfn 保存了可映射的最高页的编号。内核会在启动日志中报告找到的内存的数量。</p><p></p><p><div class="sr-rd-content-center-small"><img class="simpread-img-broken" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACbklEQVRoQ+2aMU4dMRCGZw6RC1CSSyQdLZJtKQ2REgoiRIpQkCYClCYpkgIESQFIpIlkW+IIcIC0gUNwiEFGz+hlmbG9b1nesvGW++zxfP7H4/H6IYzkwZFwQAUZmpJVkSeniFJKA8ASIi7MyfkrRPxjrT1JjZ8MLaXUDiJuzwngn2GJaNd7vyP5IoIYY94Q0fEQIKIPRGS8947zSQTRWh8CwLuBgZx479+2BTkHgBdDAgGAC+fcywoyIFWqInWN9BSONbTmFVp/AeA5o+rjKRJ2XwBYRsRXM4ZXgAg2LAPzOCDTJYQx5pSIVlrC3EI45y611osMTHuQUPUiYpiVooerg7TWRwDAlhSM0TuI+BsD0x4kGCuFSRVzSqkfiLiWmY17EALMbCAlMCmI6IwxZo+INgQYEYKBuW5da00PKikjhNNiiPGm01rrbwDwofGehQjjNcv1SZgddALhlJEgwgJFxDNr7acmjFLqCyJuTd6LEGFttpmkYC91Hrk3s1GZFERMmUT01Xv/sQljjPlMRMsxO6WULwnb2D8FEs4j680wScjO5f3vzrlNJszESWq2LYXJgTzjZm56MCHf3zVBxH1r7ftU1splxxKYHEgoUUpTo+grEf303rPH5hxENJqDKQEJtko2q9zGeeycWy3JhpKhWT8+NM/sufIhBwKI+Mta+7pkfxKMtd8Qtdbcx4dUQZcFCQ2I6DcAnLUpf6YMPxhIDDOuxC4C6djoQUE6+tKpewWZ1wlRkq0qUhXptKTlzv93aI3jWmE0Fz2TeujpX73F9TaKy9CeMk8vZusfBnqZ1g5GqyIdJq+XrqNR5AahKr9CCcxGSwAAAABJRU5ErkJggg==" org-src="https://blog.csdn.net/gatieme/article/images/i386-setup_memory.jpg" sr-org-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACbklEQVRoQ+2aMU4dMRCGZw6RC1CSSyQdLZJtKQ2REgoiRIpQkCYClCYpkgIESQFIpIlkW+IIcIC0gUNwiEFGz+hlmbG9b1nesvGW++zxfP7H4/H6IYzkwZFwQAUZmpJVkSeniFJKA8ASIi7MyfkrRPxjrT1JjZ8MLaXUDiJuzwngn2GJaNd7vyP5IoIYY94Q0fEQIKIPRGS8947zSQTRWh8CwLuBgZx479+2BTkHgBdDAgGAC+fcywoyIFWqInWN9BSONbTmFVp/AeA5o+rjKRJ2XwBYRsRXM4ZXgAg2LAPzOCDTJYQx5pSIVlrC3EI45y611osMTHuQUPUiYpiVooerg7TWRwDAlhSM0TuI+BsD0x4kGCuFSRVzSqkfiLiWmY17EALMbCAlMCmI6IwxZo+INgQYEYKBuW5da00PKikjhNNiiPGm01rrbwDwofGehQjjNcv1SZgddALhlJEgwgJFxDNr7acmjFLqCyJuTd6LEGFttpmkYC91Hrk3s1GZFERMmUT01Xv/sQljjPlMRMsxO6WULwnb2D8FEs4j680wScjO5f3vzrlNJszESWq2LYXJgTzjZm56MCHf3zVBxH1r7ftU1splxxKYHEgoUUpTo+grEf303rPH5hxENJqDKQEJtko2q9zGeeycWy3JhpKhWT8+NM/sufIhBwKI+Mta+7pkfxKMtd8Qtdbcx4dUQZcFCQ2I6DcAnLUpf6YMPxhIDDOuxC4C6djoQUE6+tKpewWZ1wlRkq0qUhXptKTlzv93aI3jWmE0Fz2TeujpX73F9TaKy9CeMk8vZusfBnqZ1g5GqyIdJq+XrqNR5AahKr9CCcxGSwAAAABJRU5ErkJggg=="></div></p><p></p><h1 id="sr-toc-12"><a name="t12"></a>5 bootmem 分配内存接口</h1><p></p><p></p><p>bootmem 提供了各种函数用于在初始化期间分配内存.</p><p></p><p>尽管 <a href="http://lxr.free-electrons.com/source/mm/nobootmem.c?v4.7">mm/bootmem.c</a> 中提供了一些了的内存分配函数，但是这些函数大多数以__下划线开头, 这个标识告诉我们尽量不要使用他们, 他们过于底层, 往往是不安全的, 因此特定于某个体系架构的代码并没有直接调用它们，而是通过 <a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v4.7">linux/bootmem.h</a> 提供的一系列的宏</p><p></p><h2 id="sr-toc-13"><a name="t13"></a>5.1 NUMA 结构的分配函数</h2><p></p><p></p><p>首先我们讲解一下子在 UMA 系统中, 可供使用的函数.</p><p></p><h2 id="sr-toc-14"><a name="t14"></a>5.1.1 从 ZONE_NORMAL 区域分配函数</h2><p></p><p></p><p>下面列出的这些函数可以从 ZONE_NORMAL 内存域分配指向大小的内存</p><p></p><div><table><thead><tr><th align="center">函数</th><th align="center">描述</th><th align="center">定义</th></tr></thead><tbody><tr><td align="center"> alloc_bootmem(size)</td><td align="center"> 按照指定大小在 ZONE_NORMAL 内存域分配函数. 数据是对齐的, 这使得内存或者从可适用于 L1 高速缓存的理想位置开始 </td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L122">alloc_bootmem</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L700">__alloc_bootmem</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?=4.7#L672">___alloc_bootmem</a></td></tr><tr><td align="center">alloc_bootmem_align(x, align)</td><td align="center"> 同 alloc_bootmem 函数, 按照指定大小在 ZONE_NORMAL 内存域分配函数, 并按照 align 进行数据对齐 </td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L124">alloc_bootmem_align</a><br>基于__alloc_bootmem 实现</td></tr><tr><td align="center"> alloc_bootmem_pages(size))</td><td align="center"> 同 alloc_bootmem 函数, 按照指定大小在 ZONE_NORMAL 内存域分配函数, 其中_page 只是指定数据的对其方式从页边界 (__pages) 开始 </td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L128">alloc_bootmem_pages</a><br>基于__alloc_bootmem 实现</td></tr><tr><td align="center"> alloc_bootmem_nopanic(size)</td><td align="center">alloc_bootmem_nopanic 是最基础的通用的，一个用来尽力而为分配内存的函数，它通过 list_for_each_entry 在全局链表 bdata_list 中分配内存. alloc_bootmem 和 alloc_bootmem_nopanic 类似，它的底层实现首先通过 alloc_bootmem_nopanic 函数分配内存，但是一旦内存分配失败，系统将通过 panic(“Out of memory”) 抛出信息，并停止运行 </td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L126">alloc_bootmem_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L664">__alloc_bootmem_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L632">___alloc_bootmem_nopanic</a></td></tr></tbody></table></div><p></p><p></p><p>这些函数的定义在 <a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L122">include/linux/bootmem.h</a></p><p></p><pre name="code" class="hljs cpp">http:<span class="hljs-comment">//lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L122</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem(x) \
    __alloc_bootmem(x, SMP_CACHE_BYTES, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_align(x, align) \
    __alloc_bootmem(x, align, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_nopanic(x) \
    __alloc_bootmem_nopanic(x, SMP_CACHE_BYTES, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_pages(x) \
    __alloc_bootmem(x, PAGE_SIZE, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_pages_nopanic(x) \
    __alloc_bootmem_nopanic(x, PAGE_SIZE, BOOTMEM_LOW_LIMIT)</span></pre><p></p><h2 id="sr-toc-15"><a name="t15"></a>5.1.2 从 ZONE_DMA 区域分配函数</h2><p></p><p></p><p>下面的函数可以从 ZONE_DMA 中分配内存 <br> <br></p><p></p><div><table><thead><tr><th align="center">函数</th><th align="center">描述</th><th align="center">定义</th></tr></thead><tbody><tr><td align="center"> alloc_bootmem_low(size)</td><td align="center"> 按照指定大小在 ZONE_DMA 内存域分配函数. 类似于 alloc_bootmem, 数据是对齐的 </td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L141">alloc_bootmem_low_pages_nopanic</a><br>底层基于___alloc_bootmem</td></tr><tr><td align="center">alloc_bootmem_low_pages_nopanic(size)</td><td align="center"> 按照指定大小在 ZONE_DMA 内存域分配函数. 类似于 alloc_bootmem_pages, 数据在页边界对齐, 并且错误后不输出 panic</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L143">alloc_bootmem_low_pages_nopanic</a><br>底层基于<a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L838">__alloc_bootmem_low_nopanic</a></td></tr><tr><td align="center">alloc_bootmem_low_pages(size)</td><td align="center"> 按照指定大小在 ZONE_DMA 内存域分配函数. 类似于 alloc_bootmem_pages, 数据在页边界对齐 </td><td align="center"><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L832">alloc_bootmem_low_pages</a><br>底层基于<a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L838">__alloc_bootmem_low_nopanic</a></td></tr></tbody></table></div><p></p><p></p><p>这些函数的定义在 <a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L141">include/linux/bootmem.h</a></p><p></p><pre name="code" class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_low(x) \
    __alloc_bootmem_low(x, SMP_CACHE_BYTES, 0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_low_pages_nopanic(x) \
    __alloc_bootmem_low_nopanic(x, PAGE_SIZE, 0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_low_pages(x) \
    __alloc_bootmem_low(x, PAGE_SIZE, 0)</span></pre><p></p><h2 id="sr-toc-16"><a name="t16"></a>5.1.3 函数实现方式</h2><p></p><p></p><p>通过分析我们可以看到 alloc_bootmem_nopanic 的底层实现函数<a href="http://lxr.free-electrons.com/source/mm/nobootmem.c?v4.7#L273"><em>__alloc_bootmem_nopanic</em></a> 实现了一套最基础的内存分配函数, 而<a href="http://lxr.free-electrons.com/source/mm/nobootmem.c?v=4.7#L281">___alloc_bootmem 函数</a>则通过___alloc_bootmem_nopanic 函数实现, 它首先通过___alloc_bootmem_nopanic 函数分配内存，但是一旦内存分配失败，系统将通过<code>panic("Out of memory")</code>抛出信息，并停止运行, 其他的内存分配函数除了都是基于 alloc_bootmem_nopanic 族的函数, 都是基于__alloc_bootmem 的. 那么所有的函数都是间接的基于___alloc_bootmem_nopanic 实现的</p><p></p><pre name="code" class="hljs cpp"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> * __init ___alloc_bootmem(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> align,
                    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> goal, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> limit)
{
    <span class="hljs-keyword">void</span> *mem = ___alloc_bootmem_nopanic(size, align, goal, limit);

    <span class="hljs-keyword">if</span> (mem)
        <span class="hljs-keyword">return</span> mem;
    <span class="hljs-comment">/*
     * Whoops, we cannot satisfy the allocation request.
     */</span>
    pr_alert(<span class="hljs-string">"bootmem alloc of %lu bytes failed!\n"</span>, size);
    panic(<span class="hljs-string">"Out of memory"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}</pre><p></p><p>所有这些分配函数最后都是间接的通过<strong>___alloc_bootmem_nopanic</strong> 函数来完成内存分配的, 该函数定义在 <a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L632">mm/bootmem.c?v=4.7, line 632</a></p><p></p><pre name="code" class="hljs cpp"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> * __init ___alloc_bootmem_nopanic(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size,
                          <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> align,
                          <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> goal,
                          <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> limit)
{
    <span class="hljs-keyword">void</span> *ptr;

restart:
    ptr = alloc_bootmem_core(size, align, goal, limit);
    <span class="hljs-keyword">if</span> (ptr)
        <span class="hljs-keyword">return</span> ptr;
    <span class="hljs-keyword">if</span> (goal) {
        goal = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">goto</span> restart;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}</pre><p></p><h2 id="sr-toc-17"><a name="t17"></a>5.2 NUMA 结构下的分配函数</h2><p></p><p></p><h2 id="sr-toc-18"><a name="t18"></a>5.2.1 分配函数接口</h2><p></p><p></p><p>在 NUMA 系统上, 基本的 API 是相同的, 但是函数增加了_node 后缀, 与 UMA 系统的函数相比, 还需要一些额外的参数, 用于指定内存分配的结点.</p><p></p><div><table><thead><tr><th align="center">函数</th><th align="center">定义</th></tr></thead><tbody><tr><td align="center"> alloc_bootmem_node(pgdat, size)</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L132">alloc_bootmem_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L777">__alloc_bootmem_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L708"> ___alloc_bootmem_node</a></td></tr><tr><td align="center">alloc_bootmem_node_nopanic(pgdat, size)</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L134">alloc_bootmem_node_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L738">__alloc_bootmem_node_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L708">___alloc_bootmem_node_nopanic</a></td></tr><tr><td align="center">alloc_bootmem_pages_node(pgdat, size)</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L136">alloc_bootmem_pages_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L747">__alloc_bootmem_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L708">___alloc_bootmem_node_nopanic</a></td></tr><tr><td align="center">alloc_bootmem_pages_node_nopanic(pgdat, size)</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L138">alloc_bootmem_pages_node_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L738">__alloc_bootmem_node_nopanic</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L708">___alloc_bootmem_node_nopanic</a></td></tr><tr><td align="center">alloc_bootmem_low_pages_node(pgdat, size)</td><td align="center"><a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L14">alloc_bootmem_low_pages_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L861">__alloc_bootmem_low_node</a><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L747">___alloc_bootmem_node</a><br><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L707">___alloc_bootmem_node_nopanic</a></td></tr></tbody></table></div><p></p><p>这些函数定义在 <a href="http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L141">include/linux/bootmem.h</a> 和 <a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7">mm/bootmem.c</a></p><p></p><pre name="code" class="hljs cpp"><span class="hljs-comment">//  http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L132</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_node(pgdat, x) \
    __alloc_bootmem_node(pgdat, x, SMP_CACHE_BYTES, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_node_nopanic(pgdat, x) \
    __alloc_bootmem_node_nopanic(pgdat, x, SMP_CACHE_BYTES, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_pages_node(pgdat, x) \
    __alloc_bootmem_node(pgdat, x, PAGE_SIZE, BOOTMEM_LOW_LIMIT)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_pages_node_nopanic(pgdat, x) \
    __alloc_bootmem_node_nopanic(pgdat, x, PAGE_SIZE, BOOTMEM_LOW_LIMIT)</span>

<span class="hljs-comment">//  http://lxr.free-electrons.com/source/include/linux/bootmem.h?v=4.7#L147</span>
    __alloc_bootmem_low(x, PAGE_SIZE, <span class="hljs-number">0</span>)
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloc_bootmem_low_pages_node(pgdat, x) \
    __alloc_bootmem_low_node(pgdat, x, PAGE_SIZE, 0)</span></pre><p></p><h2 id="sr-toc-19"><a name="t19"></a>5.2.2 函数实现方式</h2><p></p><p></p><p>NUMA 结构下这些分配接口的实现方式与 UMA 结构下类似, 这些都是<em>__alloc_bootmem_node 或者</em>__alloc_bootmem_node_nopanic, 而___alloc_bootmem_node 函数则先通过___alloc_bootmem_node_nopanic 分配内存空间, 如果出错则打印<code>panic("Out of memory")</code>, 并终止</p><p></p><pre name="code" class="hljs cpp"><span class="hljs-keyword">void</span> * __init ___alloc_bootmem_node(<span class="hljs-keyword">pg_data_t</span> *pgdat, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size,
                    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> align, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> goal,
                    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> limit)
{
    <span class="hljs-keyword">void</span> *ptr;

    ptr = ___alloc_bootmem_node_nopanic(pgdat, size, align, goal, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (ptr)
        <span class="hljs-keyword">return</span> ptr;

    pr_alert(<span class="hljs-string">"bootmem alloc of %lu bytes failed!\n"</span>, size);
    panic(<span class="hljs-string">"Out of memory"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}</pre><p></p><p>那么我们现在就进入分配函数的核心___alloc_bootmem_node_nopanic, 它定义在 <a href="http://lxr.free-electrons.com/source/mm/nobootmem.c?v=4.7#L317">mm/nobootmem.c?v=4.7, line 317</a></p><p></p><pre name="code" class="hljs cpp"><span class="hljs-keyword">void</span> * __init ___alloc_bootmem_node_nopanic(<span class="hljs-keyword">pg_data_t</span> *pgdat,
                <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> align,
                <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> goal, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> limit)
{
    <span class="hljs-keyword">void</span> *ptr;

    <span class="hljs-keyword">if</span> (WARN_ON_ONCE(slab_is_available()))
        <span class="hljs-keyword">return</span> kzalloc(size, GFP_NOWAIT);
again:

    <span class="hljs-comment">/* do not panic in alloc_bootmem_bdata() */</span>
    <span class="hljs-keyword">if</span> (limit &amp;&amp; goal + size &gt; limit)
        limit = <span class="hljs-number">0</span>;

    ptr = alloc_bootmem_bdata(pgdat-&gt;bdata, size, align, goal, limit);
    <span class="hljs-keyword">if</span> (ptr)
        <span class="hljs-keyword">return</span> ptr;

    ptr = alloc_bootmem_core(size, align, goal, limit);
    <span class="hljs-keyword">if</span> (ptr)
        <span class="hljs-keyword">return</span> ptr;

    <span class="hljs-keyword">if</span> (goal) {
        goal = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">goto</span> again;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
}</pre><p></p><p>我们可以看到 UMA 下底层的分配函数___alloc_bootmem_nopanic 与 NUMA 下的函数___alloc_bootmem_node_nopanic 实现方式基本类似. 参数也基本相同</p><p></p><div><table><thead><tr><th align="center">参数</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"> pgdat</td><td align="center"> 要分配的结点， 在 UMA 结构中, 它被缺省掉了, 因此其默认值是 contig_page_data</td></tr><tr><td align="center">size</td><td align="center"> 要分配的内存区域大小</td></tr><tr><td align="center"> align</td><td align="center"> 要求对齐的字节数. 如果分配的空间比较小, 就用 SMP_CACHE_BYTES， 它一般是硬件一级高速缓存的对齐方式, 而 PAGE_SIZE 则表示要在页边界对齐</td></tr><tr><td align="center"> goal</td><td align="center"> 最佳分配的起始地址, 一般设置 (normal)BOOTMEM_LOW_LIMIT / (low)ARCH_LOW_ADDRESS_LIMIT</td></tr></tbody></table></div><p></p><h2 id="sr-toc-20"><a name="t20"></a>5.3 __alloc_memory_core 进行内存分配</h2><p></p><p></p><div><table><thead><tr><th align="center">函数</th><th align="center">描述</th><th align="center">定义</th></tr></thead><tbody><tr><td align="center"> alloc_bootmem_bdata</td><td align="center"></td><td align="center"><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L500">mm/bootmem.c?v=4.7, line 500</a></td></tr><tr><td align="center">alloc_bootmem_core</td><td align="center"></td><td align="center"><a href="http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L607">mm/bootmem.c, line 607</a></td></tr></tbody></table></div><p></p><p>__alloc_memory_core 函数的功能相对而言很广泛 (在启动期间不需要太高的效率), 该函数基于最先适配算法, 但是该分配器不仅可以分配整个内存页, 还能分配页的一部分. 它遍历所有的 bootmem list 然后找到一个合适的内存区域, 然后通过 alloc_bootmem_bdata 来完成分配</p><p></p><p>该函数主要执行如下操作</p><p></p><ul><li><p>list_for_each_entry 从 goal 开始扫描为图, 查找满足分配请求的空闲内存区</p></li><li><p>然后通过 alloc_bootmem_bdata 完成内存的分配</p> 
  <ol><li><p>如果目标页紧接着上一次分配的页即 last_end_off, 则内核会判断所需的内存 (包括对齐数据所需的内存) 是否能够在上一页分配或者从上一页开始分配</p></li><li><p>新分配的页在位图中对应位置设置为 1,, 如果该页未完全分配, 则相应的偏移量保存在 bootmem_data-&gt;last_end_off 中; 否则, 该值设为 0</p></li></ol></li></ul><p></p><h1 id="sr-toc-21"><a name="t21"></a>6 bootmem 释放内存</h1><p></p><p></p><p>内核提供了 free_bootmem 函数来释放内存</p><p></p><p>它需要两个参数：需要释放的内存区的起始地址和长度。不出意外，NUMA 系统上等价函数的名称为 free_bootmem_node，它需要一个额外的参数来指定结点</p><p></p><pre name="code" class="hljs cpp"><span class="hljs-comment">//  http://lxr.free-electrons.com/source/mm/bootmem.c?v=4.7#L422</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">free_bootmem</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> addr, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">free_bootmem_node</span><span class="hljs-params">(<span class="hljs-keyword">pg_data_t</span> *pgdat, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> addr, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> size)</span></span>;</pre><p></p><h1 id="sr-toc-22"><a name="t22"></a>7 停用 bootmem</h1><p></p><p></p><p>在系统初始化进行到伙伴系统分配器能够承担内存管理的责任后，必须停用 bootmem 分配器，毕竟不能同时用两个分配器管理内存。在 UMA 和 NUMA 系统上，停用是由 <a href="http://lxr.free-electrons.com/source/mm/bootmem.c#L247">free_all_bootmem</a> 完成。在伙伴系统建立之后，特定于体系结构的初始化代码需要调用这个函数</p><p></p><p>首先扫描 bootmem 分配器的页位图，释放每个未用的页。到伙伴系统的接口是__free_pages_bootmem 函数，该函数对每个空闲页调用。该函数内部依赖于标准函数__free_page。它使得这些页并入伙伴系统的数据结构，在其中作为空闲页管理，可用于分配。</p><p></p><p>在页位图已经完全扫描之后，它占据的内存空间也必须释放。此后，只有伙伴系统可用于内存分配。</p><p></p><h1 id="sr-toc-23"><a name="t23"></a>链接</h1><p></p><p></p><p></p><p><a href="http://blog.csdn.net/vanbreaker/article/details/7554977">Linux 节点和内存管理区的初始化</a></p><p></p><p><a href="http://blog.csdn.net/yuzhihui_no1/article/details/50759567">linux 内存管理之初始化 zonelists</a></p><p></p><p><a href="http://www.cnblogs.com/zhenjing/archive/2012/03/21/linux_numa.html">Linux-2.6.32 NUMA 架构之内存和调度</a></p><p></p><p><a href="http://www.linuxidc.com/Linux/2012-05/60230.htm">Linux 节点和内存管理区的初始化</a></p><p></p><p><a href="http://bbs.chinaunix.net/thread-4141073-1-1.html">[内存管理] bootmem 没了？</a></p><p></p><p><a href="http://blog.chinaunix.net/uid-26009923-id-3860465.html">linux_3.0.1 分析 3–arm 内存初始化 2-qemu </a></p><p></p><p><a href="http://www.linuxidc.com/Linux/2012-02/53139.htm">Linux 内存模型之 bootmem 分配器</a></p><p></p><p><a href="http://blog.chinaunix.net/uid-7588746-id-1629805.html">Vi Linux 内存 之 bootmem 分配器（一） </a></p><p></p><p><a href="http://blog.csdn.net/xxxxxlllllxl/article/details/12091667">linux-3.2.36 内核启动 1 - 启动参数（arm 平台 启动参数的获取和处理，分析 setup_arch）</a></p></sr-rd-content>
                            
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://blog.csdn.net/gatieme/article/details/52403177" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    </body>
                </html>