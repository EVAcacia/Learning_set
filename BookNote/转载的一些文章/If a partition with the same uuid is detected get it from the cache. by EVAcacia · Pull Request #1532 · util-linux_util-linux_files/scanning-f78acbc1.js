System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(H,q){"use strict";var u,g,x,S;return{setters:[function(l){u=l.a,g=l.o,x=l.k},function(l){S=l.E}],execute:function(){var l=Object.defineProperty,w=(t,e)=>l(t,"name",{value:e,configurable:!0});function A(t){const e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",t.name),e.setAttribute("value",t.value),e}w(A,"copyInput");function v(t){let e=!1;const o=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),n=o.length!==0?JSON.parse(o[0].getAttribute("data-numbers")||"[]"):[];for(const r of t.querySelectorAll(".js-scanning-bulk-action-items")){r.innerHTML="";const s=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const i of s)e||(e=n.indexOf(parseInt(i.value))!==-1),r.appendChild(A(i))}for(const r of t.querySelectorAll(".js-scanning-reopen-button"))r.hidden=e;for(const r of t.querySelectorAll(".js-scanning-reopen-button-disabled"))r.hidden=!e}w(v,"copyCheckedAlertsToBulkActionForms"),u("change",".js-scanning-alert-check",function({currentTarget:t}){const e=t.closest(".js-scanning-alert-list"),o=e.querySelector(".js-scanning-alert-check:checked")!=null,n=e.querySelector(".js-scanning-filter-options"),r=e.querySelector(".js-scanning-alert-bulk-actions"),s=e.querySelector(".js-scanning-alert-links");n&&(n.hidden=o),r&&(r.hidden=!o),s&&(s.hidden=o),v(e)}),u("details-menu-selected",".js-scanning-code-path-menu",function(t){const e=t.detail.relatedTarget.getAttribute("data-target-code-path");for(const o of document.querySelectorAll(".js-scanning-code-path"))o.hidden=e!==o.getAttribute("data-code-path")},{capture:!0});var P=Object.defineProperty,a=(t,e)=>P(t,"name",{value:e,configurable:!0});g(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const t=document.querySelector(".js-post-processing-expression-count");t&&t.textContent&&(window.postProcessingExpressionCount=parseInt(t.textContent))}}),u("click",".js-add-secret-format-button",t=>{const e=t.currentTarget;if(!!e&&window.postProcessingExpressionCount<p()){const o=document.querySelectorAll(".js-additional-secret-format");if(!o)return;for(const n of o)if(n.classList.contains("has-removed-contents")){n.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===p()&&(e.hidden=!0);break}}}),u("click",".js-remove-secret-format-button",t=>{const e=document.querySelector(".js-add-secret-format-button");if(!e)return;const o=t.currentTarget;if(!o)return;const n=o.closest(".js-additional-secret-format");if(!n)return;n.classList.toggle("has-removed-contents",!0);const r=n.getElementsByClassName("js-post-processing-input")[0];r.value="";const s=n.getElementsByClassName("errored")[0];s&&(s.classList.toggle("errored",!1),h(window.codeEditor.getValue())),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<p()&&(e.hidden=!1)}),g(".js-test-code",{async add(){const t=document.querySelector(".js-test-code"),e=t.clientHeight,o=await q.import("./chunk-codemirror.js");if(window.codeEditor=o.default.fromTextArea(t,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:t.value,lineSeparator:`\r
`,theme:"github-light"}),e!==0){const n=document.querySelector(".CodeMirror");n&&(n.style.height=`${e}px`,n.style.border="1px solid #e1e4e8",n.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",()=>{h(window.codeEditor.getValue())})}}),S(".js-custom-secret-scanning-pattern-form *",async function(t){if(!window.codeEditor)return;const e=t.currentTarget;h(window.codeEditor.getValue(),e)});const L=a((t,e,o)=>{const n=document.createElement("input");n.type="hidden",n.name=e,n.id=e,n.value=o,t.appendChild(n),n.required=!0},"createHiddenInputField"),h=x(function(t,e=void 0){const o=document.querySelector(".js-custom-pattern-submit-button");if(!(o instanceof HTMLElement))return;const n=document.querySelector(".js-update-pattern-info");if(e&&e.id==="display_name"&&n){o.removeAttribute("disabled");return}const r=document.querySelector(".js-test-pattern-matches");if(!!r)if(t.length===0)o.setAttribute("disabled","true"),r.textContent="";else{window.codeEditor.save();const s=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(s instanceof HTMLFormElement))return;const i=document.querySelector(".js-custom-secret-scanning-pattern-form");if(!(i instanceof HTMLFormElement))return;for(const c of i.elements)c instanceof HTMLInputElement&&c.name&&(c.type==="text"||c.type==="radio"&&c.checked)&&L(s,c.name,c.value);I(s,F(i,o,n),M(r))}},300),M=a(t=>e=>{if(e.length===0)t.textContent=" - No matches";else if(e.length===1)t.textContent=" - 1 match";else{const o=[];for(const s of e)o.push(JSON.stringify(s));const r=[...new Set(o)];t.textContent=` - ${r.length} matches`}},"getTestLabelUpdater"),F=a((t,e,o)=>n=>{if(T(t),n==null?void 0:n.message){if(e.setAttribute("disabled","true"),o)o.hidden=!0;else if((n==null?void 0:n.error_type)==="START_DELIMITER"||(n==null?void 0:n.error_type)==="END_DELIMITER"||(n==null?void 0:n.error_type)==="MUST_MATCH"||(n==null?void 0:n.error_type)==="MUST_NOT_MATCH"){const r=document.querySelector(".js-more-options.js-details-container");r&&(r.classList.add("open"),r.classList.add("Details--on"))}return _(t,n),!1}else return e.removeAttribute("disabled"),o&&(o.hidden=!1),!0},"getTestErrorHandler");function _(t,e){var o;if(e.error_type==="MUST_MATCH"||e.error_type==="MUST_NOT_MATCH"){let n=0;const r=t.getElementsByClassName("js-additional-secret-format");for(const s of r){if(n>(e.error_index||0))return;const c=[...s.getElementsByTagName("input")].filter(m=>m.checked),C=c&&((o=c[0])==null?void 0:o.value.toUpperCase()),B=C===e.error_type&&n===e.error_index,b=[...s.getElementsByTagName("input")].filter(m=>m.type==="text");if(!b||b.length===0)continue;const d=b[0];if(d.value!=="")if(B){const m=d.id;d&&d.parentElement&&y(d.parentElement);const f=document.createElement("p"),k=`${m}_error_message`;f.classList.add("note","error","mt-5"),f.id=k,f.textContent=e.message,d==null||d.setAttribute("aria-describedby",k),d==null||d.insertAdjacentElement("afterend",f);return}else C===e.error_type&&n++}}else{const n=N[e.error_type],r=document.querySelector(`#${n}`);r&&r.parentElement&&y(r.parentElement);const s=document.createElement("p"),i=`${n}_error_message`;s.classList.add("note","error"),s.id=i,s.textContent=e.message,r==null||r.setAttribute("aria-describedby",i),r==null||r.insertAdjacentElement("afterend",s)}}a(_,"showInputErrorState");function T(t){var e,o;const n=document.querySelector(".js-error-banner");n.hidden=!0;for(const r of t.getElementsByTagName("input"))if((e=r.parentElement)==null?void 0:e.classList.contains("errored")){j(r.parentElement);const s=r.getAttribute("aria-describedby");(o=document.querySelector(`#${s}`))==null||o.remove()}}a(T,"clearInputErrorState");function p(){const t=document.querySelector(".js-post-processing-expression-max-count");if(!t)return 5;const e=t.textContent;return e?parseInt(e):5}a(p,"getMaxPostProcessingExpressions");function y(t){t==null||t.classList.add("form-group","errored","my-0")}a(y,"addErrorStylingToInput");function j(t){t==null||t.classList.remove("form-group","errored","my-0")}a(j,"removeErrorStylingFromInput");function E(){if(!window.codeEditor)return;const t=window.codeEditor.posFromIndex(0),e=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const o of window.codeEditor.findMarks(t,e))o.clear()}a(E,"clearCodeHighlights");const N={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function I(t,e,o){let n;try{const r=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});r.ok&&(n=await r.json())}catch(r){}if(n&&e(n.error))if(n.has_matches){const r=JSON.parse(n.matches);E(),o(r);for(const s of r){const i=window.codeEditor.posFromIndex(s.start),c=window.codeEditor.posFromIndex(s.end);window.codeEditor.markText(i,c,{className:"text-bold hx_keyword-hl rounded-1 d-inline-block"})}}else o([]),E()}a(I,"updatePatternMatches")}}});
//# sourceMappingURL=scanning-7668d502.js.map
